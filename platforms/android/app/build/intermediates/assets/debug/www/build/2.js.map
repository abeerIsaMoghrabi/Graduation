{"version":3,"sources":["../../src/pages/viewer/viewer.module.ts","../../src/pages/viewer/viewer.ts"],"names":[],"mappings":"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","file":"2.js","sourcesContent":["import { NgModule } from '@angular/core';\r\nimport { IonicPageModule } from 'ionic-angular';\r\nimport { ViewerPage } from './viewer';\r\n\r\n@NgModule({\r\n  declarations: [\r\n    ViewerPage,\r\n  ],\r\n  imports: [\r\n    IonicPageModule.forChild(ViewerPage),\r\n  ],\r\n})\r\nexport class ViewerPageModule {}\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/pages/viewer/viewer.module.ts","import { Component } from '@angular/core';\r\nimport { IonicPage, NavController, NavParams,LoadingController, ActionSheetController, ToastController, Platform, Loading} from 'ionic-angular';\r\nimport { Camera, CameraOptions } from '@ionic-native/camera';\r\n\r\n\r\nimport { File } from '@ionic-native/file';\r\nimport { Transfer, TransferObject } from '@ionic-native/transfer';\r\nimport { FilePath } from '@ionic-native/file-path';\r\n\r\n\r\nimport { storage } from 'firebase';\r\nimport * as firebase from 'firebase/app';\r\nimport { AngularFireAuth } from 'angularfire2/auth';\r\n/**\r\n * Generated class for the ViewerPage page.\r\n *\r\n * See https://ionicframework.com/docs/components/#navigation for more info on\r\n * Ionic pages and navigation.\r\n */\r\n\r\ndeclare var cordova: any;\r\n@IonicPage()\r\n\r\n@Component({\r\n  selector: 'page-viewer',\r\n  templateUrl: 'viewer.html',\r\n})\r\nexport class ViewerPage {\r\n\r\n\tpublic base64Image: string;////\r\n    mySelectedPhoto;////\r\n   \r\n    currentPhoto;////\r\n    count=0;\r\n // BlobURL;\r\n backRemove=true;\r\n  lastImage: string = null;\r\n    loading: Loading\r\n    ver:string;\r\n    userInfo;\r\n\r\n  // constructor(public camera: Camera,public navCtrl: NavController, public navParams: NavParams ,public loadingCtrl: LoadingController) {\r\n  constructor(public navCtrl: NavController, private camera: Camera, private transfer: Transfer, private file: File, private filePath: FilePath, public actionSheetCtrl: ActionSheetController, public toastCtrl: ToastController, public platform: Platform, public loadingCtrl: LoadingController,private aFAuth: AngularFireAuth){\r\n\r\n\r\n this.loadScript ();\r\n\r\n  }\r\n\r\n\r\n public presentActionSheet() {\r\n        let actionSheet = this.actionSheetCtrl.create({\r\n            title: 'Select Image Source',\r\n            buttons: [\r\n                {\r\n                    text: 'Load from Library',\r\n                    handler: () => {\r\n                        this.takePicture(this.camera.PictureSourceType.PHOTOLIBRARY);\r\n                    }\r\n                },\r\n                {\r\n                    text: 'Use Camera',\r\n                    handler: () => {\r\n                        this.takePicture(this.camera.PictureSourceType.CAMERA);\r\n                    }\r\n                },\r\n                {\r\n                    text: 'Cancel',\r\n                    role: 'cancel'\r\n                }\r\n            ]\r\n        });\r\n        actionSheet.present();\r\n    }\r\n    public takePicture(sourceType) {\r\n        // Create options for the Camera Dialog\r\n        var options = {\r\n            quality: 100,\r\n            sourceType: sourceType,\r\n            saveToPhotoAlbum: false,\r\n            correctOrientation: true\r\n        };\r\n\r\n        // Get the data of an image\r\n        this.camera.getPicture(options).then((imagePath) => {\r\n            // Special handling for Android library\r\n            if (this.platform.is('android') && sourceType === this.camera.PictureSourceType.PHOTOLIBRARY) {\r\n                this.filePath.resolveNativePath(imagePath)\r\n                    .then(filePath => {\r\n                        let correctPath = filePath.substr(0, filePath.lastIndexOf('/') + 1);\r\n                        let currentName = imagePath.substring(imagePath.lastIndexOf('/') + 1, imagePath.lastIndexOf('?'));\r\n                        this.copyFileToLocalDir(correctPath, currentName, this.createFileName());\r\n                        this.presentToast(this.lastImage);\r\n                    });\r\n            } else {\r\n                var currentName = imagePath.substr(imagePath.lastIndexOf('/') + 1);\r\n                var correctPath = imagePath.substr(0, imagePath.lastIndexOf('/') + 1);\r\n                this.copyFileToLocalDir(correctPath, currentName, this.createFileName());\r\n                this.presentToast(this.lastImage);\r\n            }\r\n        }, (err) => {\r\n            this.presentToast('Error while selecting image.');\r\n        });\r\n    }\r\n    // Create a new name for the image\r\n    private createFileName() {\r\n        var d = new Date(),\r\n            n = d.getTime(),\r\n            newFileName =  n + \".jpg\";\r\n        return newFileName;\r\n    }\r\n\r\n// Copy the image to a local folder\r\n    private copyFileToLocalDir(namePath, currentName, newFileName) {\r\n        this.file.copyFile(namePath, currentName, cordova.file.dataDirectory, newFileName).then(success => {\r\n            this.lastImage = newFileName;\r\n        }, error => {\r\n            this.presentToast('Error while storing file.');\r\n        });\r\n    }\r\n\r\n    private presentToast(text) {\r\n        let toast = this.toastCtrl.create({\r\n            message: text,\r\n            duration: 3000,\r\n            position: 'top'\r\n        });\r\n        toast.present();\r\n    }\r\n\r\n// Always get the accurate path to your apps folder\r\n    public pathForImage(img) {\r\n        if (img === null) {\r\n            return '';\r\n        } else {\r\n            // this.presentToast(\"cordova.file.dataDirectory\" + img);\r\n            return cordova.file.dataDirectory + img;\r\n               \r\n        }\r\n    }\r\n\r\n\r\n\r\n  ionViewDidLoad() {\r\n   // console.log('ionViewDidLoad ViewerPage');\r\n    this.aFAuth.authState.subscribe(data => {\r\n      if (data && data.email && data.uid) {\r\n        console.log('Welcome to APP_NAME' +data.email );\r\n         this.userInfo=data.uid;\r\n      }\r\n      else {\r\n         console.log(\" Could not find authentication details\");\r\n         \r\n      }\r\n    });\r\n  }\r\n\r\n  takePhoto(){\r\n\r\n  const options: CameraOptions = {\r\n    quality: 100,\r\n    targetHeight: 200,\r\n    targetWidth: 200,\r\n    destinationType: this.camera.DestinationType.DATA_URL,\r\n    encodingType: this.camera.EncodingType.JPEG,\r\n    mediaType: this.camera.MediaType.PICTURE,\r\n    sourceType: this.camera.PictureSourceType.PHOTOLIBRARY\r\n  }\r\n\r\n\r\n this.camera.getPicture(options).then((imageData) => {\r\n this.loading = this.loadingCtrl.create({\r\n content:\"Taking photo wait ....\"\r\n });\r\n this.loading.present();\r\n this.mySelectedPhoto =\r\n this.dataURLtoBlob('data:image/jpeg;base64,' + imageData);\r\n this.upload();\r\n\r\n}, (err) => {\r\n // Handle error\r\n});\r\n\r\n  }\r\n\r\n   dataURLtoBlob(myURL){\r\n      let binary = atob(myURL.split(',')[1]);\r\n  let array = [];\r\n  for (let i = 0 ; i < binary.length;i++){\r\n      array.push(binary.charCodeAt(i));\r\n  }\r\n      return new Blob([new Uint8Array(array)],{type:'image/jpeg'});\r\n  }\r\n\r\n  upload(){\r\n  if(this.mySelectedPhoto){\r\n      var uploadTask = firebase.storage().ref().child(this.userInfo+'/'+this.count+'.jpg').put(this.mySelectedPhoto);\r\n\r\n      this.count++;\r\n      uploadTask.then(this.onSuccess,this.onErrors);\r\n  }\r\n  }\r\n\r\n  onSuccess=(snapshot)=>{\r\n      this.mySelectedPhoto = snapshot.downloadURL;\r\n      this.loading.dismiss();\r\n  }\r\n\r\n  onErrors=(error)=>{\r\n      console.log(error);\r\n      this.loading.dismiss();\r\n  }\r\n\r\n  loadScript () { var script = document.createElement('script');\r\n   script.type = 'text/javascript'; \r\n   script.src = 'assets/js/api.js'; \r\n   document.body.appendChild(script); }\r\n\r\n   enableB(){\r\n       this.backRemove=false;\r\n   }\r\n\r\n   goToA(){\r\n       this.navCtrl.push('VoiceAudioPage', {\r\n\r\n      data:this.userInfo.replace(/\\s/g, \"\")\r\n\r\n    });\r\n   }\r\n   // store(){\r\n   // const  ImgURL=\"../../assets/imgs/face.jpg\"\r\n   // //this.pathForImage(this.lastImage);\r\n   // this. BlobURL= this.dataURLtoBlob('data:image/jpeg;base64,' + ImgURL);\r\n   // this.upload();\r\n   // }\r\n\r\n  \r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/pages/viewer/viewer.ts"],"sourceRoot":""}